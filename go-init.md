---
title: Go initå‡½æ•°è¯¦è§£
date: 2018-12-05 21:24:32
tags: go
categories: go
---
> go ä¸€å¤©ä¸ç”¨å°±å¿˜äº†è¿™ä¸ªï¼Œmarkä¸€ä¸ªä»¥é˜²ä¸‡ä¸€ğŸ‘¿

`init()`å‡½æ•°ä¼šåœ¨æ¯ä¸ªåŒ…å®Œæˆåˆå§‹åŒ–åè‡ªåŠ¨æ‰§è¡Œï¼Œå¹¶ä¸”æ‰§è¡Œä¼˜å…ˆçº§æ¯”mainå‡½æ•°é«˜ã€‚init å‡½æ•°é€šå¸¸è¢«ç”¨æ¥ï¼š

* å¯¹å˜é‡è¿›è¡Œåˆå§‹åŒ–
* æ£€æŸ¥/ä¿®å¤ç¨‹åºçš„çŠ¶æ€
* æ³¨å†Œ
* è¿è¡Œä¸€æ¬¡è®¡ç®—
  
<!-- more -->

# åŒ…çš„åˆå§‹åŒ–

ä¸ºäº†ä½¿ç”¨å¯¼å…¥çš„åŒ…ï¼Œé¦–å…ˆå¿…é¡»å°†å…¶åˆå§‹åŒ–ã€‚åˆå§‹åŒ–æ€»æ˜¯ä»¥å•çº¿ç¨‹æ‰§è¡Œï¼Œå¹¶ä¸”æŒ‰ç…§åŒ…çš„ä¾èµ–å…³ç³»é¡ºåºæ‰§è¡Œã€‚è¿™é€šè¿‡Golangçš„è¿è¡Œæ—¶ç³»ç»Ÿæ§åˆ¶ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

1. åˆå§‹åŒ–å¯¼å…¥çš„åŒ…ï¼ˆé€’å½’å¯¼å…¥ï¼‰
2. å¯¹åŒ…å—ä¸­å£°æ˜çš„å˜é‡è¿›è¡Œè®¡ç®—å’Œåˆ†é…åˆå§‹å€¼
3. æ‰§è¡ŒåŒ…ä¸­çš„initå‡½æ•°

[![](http://idiotsky.top/images4/go-init.png)](http://idiotsky.top/images4/go-init.png)

__initial.go__

````go
package main

import "fmt"

var _ int64=s()

func init(){
    fmt.Println("init function --->")
}

func s() int64{
    fmt.Println("function s() --->")
    return 1
}

func main(){
    fmt.Println("main --->")
}
````

__æ‰§è¡Œç»“æœ__

````
function s() --->
init function --->
main --->
````

å³ä½¿åŒ…è¢«å¯¼å…¥å¤šæ¬¡ï¼Œåˆå§‹åŒ–åªéœ€è¦ä¸€æ¬¡ã€‚

# ç‰¹æ€§

initå‡½æ•°ä¸éœ€è¦ä¼ å…¥å‚æ•°ï¼Œä¹Ÿä¸ä¼šè¿”å›ä»»ä½•å€¼ã€‚ä¸mainç›¸æ¯”è€Œè¨€ï¼Œinitæ²¡æœ‰è¢«å£°æ˜ï¼Œå› æ­¤ä¹Ÿä¸èƒ½è¢«å¼•ç”¨ã€‚

````go
package main

import "fmt"

func init(){
    fmt.Println("init")
}

func main(){
    init()
}
````

åœ¨ç¼–è¯‘ä¸Šé¢çš„å‡½æ•°æ—¶ï¼Œä¼šå‡ºé”™â€œundefinedï¼šinitâ€ã€‚

æ¯ä¸ªæºæ–‡ä»¶ä¸­å¯ä»¥åŒ…å«å¤šä¸ªinitå‡½æ•°.

````go
package main

import "fmt"

func init(){
    fmt.Println("init 1")
}

func init(){
    fmt.Println("init2")
}

func main(){
    fmt.Println("main")
}
````

æ‰§è¡Œç»“æœ

````
init1
init2
main
````

initå‡½æ•°å¸¸ç”¨çš„ä¸€ä¸ªä¾‹å­å°±æ˜¯ç”¨æ¥è®¾ç½®åˆå§‹è¡¨è¾¾å¼çš„å€¼ã€‚

````go
var precomputed=[20]float64{}

func init(){
    var current float64=1
    precomputed[0]=current
    for i:=1;i<len(precomputed);i++{
        precomputed[i]=precomputed[i-1]*1.2
    }
}
````

å› ä¸ºä¸Šé¢ä»£ç ä¸­ä¸å¯èƒ½ç”¨forå¾ªç¯æ¥ä½œä¸ºprecomputedçš„å€¼ï¼ˆè¿™æ˜¯ä¸€å¥å£°æ˜ï¼‰ï¼Œå› æ­¤å¯ä»¥ç”¨initå‡½æ•°æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚

# GoåŒ…å¯¼å…¥è§„åˆ™çš„å‰¯ä½œç”¨

Goè¦æ±‚éå¸¸ä¸¥æ ¼ï¼Œä¸å…è®¸å¼•ç”¨ä¸ä½¿ç”¨çš„åŒ…ã€‚ä½†æ˜¯æœ‰æ—¶ä½ å¼•ç”¨åŒ…åªæ˜¯ä¸ºäº†è°ƒç”¨initå‡½æ•°å»åšä¸€äº›åˆå§‹åŒ–å·¥ä½œã€‚æ­¤æ—¶ç©ºæ ‡è¯†ç¬¦ï¼ˆä¹Ÿå°±æ˜¯ä¸‹åˆ’çº¿ï¼‰çš„ä½œç”¨å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ã€‚

````go
import _ "com/pkg"
````

# å‚è€ƒ

https://blog.csdn.net/benben_2015/article/details/79486077